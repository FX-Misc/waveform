<!--
CUSTOM ELEMENT: tile-wall
BY: DM

groups is an array of objects with the following properties:
 .group_num
 .inds - id for use with typed-array-manager
 .group_n
 .canv_spa_rm - id for use with canvas-manager
 .spa_rm_bin_size
 .spa_rm_smoothing
 .canv_dir_rm - id for use with canvas-manager
 and more...


-->


<link rel="import" href="bower_components/polymer/polymer.html">
<link rel="import" href="tile-element.html">
<link rel="import" href="utils.html">

<dom-module id="tile-wall">

<template>

    <!--
    Canvases can not directly be "bound" using Polymer, so
    instead we bind ids that have a specific meaning within
    canvas-manager.  A canvas is then rendered using:
    <managed-canvas canv_id="????"></managed-canvas>
    where "????" is an id produced by the canvas-manager.
    Note that canavas-manager is a singleton, avaialble at
    window.canvas_manager.

    TODO: update this notes
    -->


    <!--
    The following elements listen for changes in the groups array.
    When they decide to produce a new plot they render it to a canvas
    using canvas-manager, and then supply the canvas_id back into
    the groups array, e.g. groups[3].dir_rm will be a canvas_id for
    use with managed-canvas elements.
    As well as setting canvases in the groups array, they also record
    the settings used to produce that canvas, e.g. groups[3].dir_smoothing.
     -->
    


    <template is="dom-repeat" items="[[groups]]">
        <tile-element 
            style$="[[_show(item)]]"
            group_num="[[index]]"
            group_model="[[item]]"
            spa_rm_height="[[options.spa_rm_height]]"
            active="{{_is_equal(item, active_group_a)}}"
            on-mouseenter="_mouseenter_tile"
            on-mouseleave="_mouseleave_tile"
            ></tile-element>        
    </template>
</template>


<script>
    "use strict";
    Polymer({
        is:'tile-wall',
        properties: {
            groups: {
                type: Array,
                value: function(){return [];},
                notify: true    
            },
            options: {
                type: Object,
                value: {} // settings for plotting
            },
            active_group_a:{
                type: Object,
                value: null,
                notify: true
            }
        },
        observers: [
            'groups_modified(groups.*)'
        ],
        groups_modified: function(change){
            
        }, _show: function(v){
            return v ? '' : 'display: none;';
        }, _mouseenter_tile: function(e){
            this.set('active_group_a', e.model.item);
        }, _mouseleave_tile: function(e){
            this.set('active_group_a', null);
        }, _is_equal: function(a,b){
            return a===b;
        }
    });
</script>

  
</dom-module>